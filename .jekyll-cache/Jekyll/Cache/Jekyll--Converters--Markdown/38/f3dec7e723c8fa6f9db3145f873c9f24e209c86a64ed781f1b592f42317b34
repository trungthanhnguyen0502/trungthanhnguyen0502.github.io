I"ˆ%<h1 id="1-google-colab">1. Google Colab</h1>

<p>LÃ m viá»‡c vá»›i Deep Learning nghÄ©a lÃ  báº¡n pháº£i nghiÃªn cá»©u vÃ  xÃ¢y dá»±ng cÃ¡c model, Ä‘Ã²i há»i mÃ¡y tÃ­nh pháº£i cÃ³ kháº£ nÄƒng tÃ­nh toÃ¡n lá»›n. QuÃ¡ trÃ¬nh training model - hay huáº¥n luyá»‡n mÃ´ hÃ¬nh thÆ°á»ng cáº§n tá»›i GPU. NgÃ y nay, khÃ´ng nháº¥t thiáº¿t pháº£i sáº¯m mÃ¡y tÃ­nh vá»›i GPU Ä‘áº¯t tiá»n, ta hoÃ n toÃ n cÃ³ thá»ƒ Ä‘Äƒng kÃ­ cÃ¡c dá»‹ch vá»¥ <strong>Cloud Computing</strong> cá»§a Google, Amazon vÃ  nhiÃªÃ¹ nhÃ  cung cáº¥p khÃ¡c. BÃ i nÃ y sáº½ hÆ°á»›ng dáº«n cÃ¡ch sá»­ dá»¥ng <strong>GPU miá»…n phÃ­</strong> trÃªn Google Colab.</p>

<p>Google Colab cung cáº¥p <strong>Colaboratory notebooks</strong> - 1 dáº¡ng tÆ°Æ¡ng tá»± nhÆ° jupyter notebook. Khi táº¡o 1 notebook, má»™t mÃ´i trÆ°á»ng áº£o sáº½ Ä‘Æ°á»£c táº¡o riÃªng cho tá»«ng ngÆ°á»i dÃ¹ng vá»›i Ä‘áº§y Ä‘á»§ nhá»¯ng tÃ­nh nÄƒng cÆ¡ báº£n, folder, package, pythonlib. Trong khi code, thiáº¿u lib nÃ o ta cÃ³ thá»ƒ <strong>pip install</strong> nhÆ° khi sá»­ dá»¥ng trÃªn mÃ¡y váº­t lÃ½. Colab há»— trá»£ khÃ¡ toÃ n diá»‡n cÃ¡c pythonlib vá»›i version má»›i nháº¥t tensoflow, keras, PyTorch, cv2 â€¦</p>

<p>LÆ°u Ã½ lÃ  báº¡n chá»‰ cÃ³ thá»ƒ train tá»‘i Ä‘a 12 tiáº¿ng liÃªn tá»¥c. Nhá»› thÆ°á»ng xuyÃªn lÆ°u model khi train trÃ¡nh viá»‡c háº¿t 12h hoáº·c máº¥t máº¡ng, khi Ä‘Ã³ báº¡n sáº½ pháº£i train láº¡i tá»« Ä‘áº§u.</p>

<p><img src="https://images.viblo.asia/4ab2c6f8-ee7d-40d3-a813-26c6c7d3739a.png" alt="" /></p>

<blockquote>
  <p><strong>H1</strong>:  Tesla K80 GPU - GPU thÆ°á»ng Ä‘Æ°á»£c assign trÃªn Google Colab</p>
</blockquote>

<h1 id="2-cÃ i-Ä‘áº·t">2. CÃ i Ä‘áº·t.</h1>
<h2 id="21-táº¡o-notebook">2.1 Táº¡o notebook</h2>

<ol>
  <li>
    <p>ÄÄƒng nháº­p Drive, táº¡o 1 thÆ° má»¥c báº¥t kÃ¬, (VD: AI_COLAB ), vÃ o thÆ° má»¥c</p>
  </li>
  <li>Chuá»™t pháº£i, chá»n <strong>More $\longrightarrow$ Colaboratory</strong>. NhÆ° váº­y ta Ä‘Ã£ táº¡o ra 1 notebook.</li>
  <li>Click vÃ o notebook vá»«a táº¡o, giao diá»‡n hiá»‡n ra khÃ¡ giá»‘ng vá»›i Jupyter notebook.</li>
</ol>

<p><img src="https://images.viblo.asia/604ed860-789b-4b73-9397-0f42edd2e1c9.jpeg" alt="" /></p>
<blockquote>
  <p><strong>H2</strong>: Táº¡o Colab notebook</p>
</blockquote>

<h2 id="22-cÃ i-Ä‘áº·t-gpu">2.2 CÃ i Ä‘áº·t GPU</h2>
<p>Khi lÃ m viá»‡c, khÃ´ng pháº£i lÃºc nÃ o cÅ©ng cáº§n pháº£i dÃ¹ng tá»›i GPU, nÃªn theo cáº¥u hÃ¬nh máº·c Ä‘á»‹nh chá»‰ cÃ³ CPU. Trong trÆ°á»ng há»£p train/inference model cáº§n tá»›i GPU, ta lÃ m theo bÆ°á»›c sau:</p>

<p><strong>Edit $\longrightarrow$ Notebook Settings $\longrightarrow$</strong> chá»n <strong>Hardware GPU</strong></p>

<p><img src="https://images.viblo.asia/fc69fbfb-f436-491f-b5a5-b547d1609caa.png" alt="" /></p>
<blockquote>
  <p><strong>H3</strong>: Setting GPU trÃªn colab notebook</p>
</blockquote>

<h2 id="23-mount-drive">2.3 Mount drive</h2>

<p>Máº·c Ä‘á»‹nh Colab notebook sáº½ khÃ´ng cÃ³ quyá»n truy cáº­p, Ä‘á»c ghi báº¥t kÃ¬ file nÃ o trÃªn Drive. Tuy nhiÃªn trong thá»±c táº¿, khi train model ta cáº§n 1 nÆ¡i chá»©a dataset dÃ¹ng Ä‘á»ƒ train model. ÄÃ³ cÃ³ thá»ƒ lÃ  Google Drive, Kaggle, Dropboxâ€¦  Viá»‡c nÃ y khÃ´ng báº¯t buá»™c nhÆ°ng cáº§n thiáº¿t náº¿u báº¡n cáº§n 1 nÆ¡i save model vÃ  dataset. Trong bÃ i nÃ y, Ä‘á»ƒ Ä‘Æ¡n giáº£n mÃ¬nh sáº½ hÆ°á»›ng dáº«n cÃ¡ch Mount Drive:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="p">.</span><span class="n">mount</span><span class="p">(</span><span class="s">'/content/drive'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Khi run 2 dÃ²ng code trÃªn, notebook sáº½ xuáº¥t hiá»‡n 1 Ä‘Æ°á»ng link Ä‘i kÃ¨m vá»›i 1 Ã´ nháº­p token.</li>
  <li>Click vÃ o link, tiáº¿n hÃ nh cáº¥p quyá»n truy cáº­p Drive.</li>
  <li>Cáº¥p quyá»n xong sáº½ hiá»‡n ra 1 Ä‘oáº¡n token. Copy token Ä‘Ã³ vÃ  Ä‘iá»n vÃ o Ã´ input trÃªn notebook, nháº¥n Enter.</li>
  <li>NhÆ° váº­y báº¡n Ä‘Ã£ hoÃ n thÃ nh viá»‡c cáº¥p quyá»n cho google colab Ä‘Æ°á»£c phÃ©p truy cáº­p vÃ o drive cá»§a báº¡n (quyá»n Ä‘á»c vÃ  ghi dá»¯ liá»‡u).</li>
</ul>

<p>Äá»ƒ tháº¥y Ä‘Æ°á»£c nhá»¯ng folder, file Ä‘Ã£ Ä‘Æ°á»£c add tá»« drive vÃ o mÃ´i trÆ°á»ng mÃ¡y áº£o nÃ y, má»Ÿ cá»­a sá»• bÃªn trÃ¡i, click vÃ o <strong>Files $\longrightarrow$ Refresh</strong>, báº¡n sáº½ tháº¥y Drive cá»§a báº¡n Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o working directory</p>

<h2 id="24-thá»­-nghiá»‡m">2.4 Thá»­ nghiá»‡m</h2>

<p>MÃ¬nh sáº½ táº¡o notebook, viáº¿t 1 Ä‘oáº¡n code táº¡o model vá»›i tensorflow Ä‘á»ƒ xem code cÃ³ hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng nhÆ° trÃªn mÃ¡y váº­t lÃ­ khÃ´ng nhÃ©. TrÆ°á»›c háº¿t táº¡o notebook, tiáº¿n hÃ nh Setup GPU nhÆ° hÆ°á»›ng dáº«n trÃªn.</p>

<p>Code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> 
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span> 
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(),</span> 
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span> 
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">)</span>  
<span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>NhÆ° váº­y, báº¡n Ä‘Ã£ cÃ³ thá»ƒ run code, train model nhÆ° bÃ¬nh thÆ°á»ng, dá»‹ch vá»¥ nÃ y cá»§a google colab khÃ¡ hay vÃ  tiá»‡n, Ä‘áº·c biá»‡t há»¯u Ã­ch phá»¥c vá»¥ quÃ¡ trÃ¬nh tá»± nghiÃªn cá»©u vÃ  há»c AI.</p>
:ET