I"<p>M·ª•c l·ª•c:</p>
<ul>
  <li><a href="#-0">Gi·ªõi thi·ªáu</a></li>
  <li><a href="#-1">1. T∆∞ t∆∞·ªüng c·ªßa YOLO</a></li>
  <li><a href="#-2">2. Chi ti·∫øt thu·∫≠t to√°n YOLO</a></li>
  <li><a href="#-3">3. Loss function c·ªßa YOLO</a></li>
</ul>

<!-- ############ -->
<p><a name="-0"></a></p>

<h3 id="gi·ªõi-thi·ªáu">Gi·ªõi thi·ªáu</h3>

<p>Trong lƒ©nh v·ª±c computer vision, c√≥ r·∫•t nhi·ªÅu ch·ªß ƒë·ªÉ, b√†i to√°n m√† con ng∆∞·ªùi ƒëang c·ªë g·∫Øng gi·∫£i quy·∫øt t·ªëi ∆∞u:</p>
<ul>
  <li>b√†i to√°n classify (ph√¢n lo·∫°i)</li>
  <li>b√†i to√°n detect (x√°c ƒë·ªãnh v·ªã tr√≠) ( detect + classify = recognize)</li>
  <li>b√†i to√°n semantic segmentation (ph√¢n ƒëo·∫°n ng·ªØ nghƒ©a)</li>
  <li>b√†i to√°n style transfer.</li>
  <li>Ngo√†i c√°c b√†i to√°n ƒë√≥ c√≤n nhi·ªÅu b√†i to√°n kh√°c nh∆∞ng kh√¥ng ph·ªï bi·∫øn b·∫±ng.</li>
</ul>

<p>Trong c√°c b√†i to√°n ƒë√≥, b√†i to√°n Object Detect l√† b√†i to√°n quan tr·ªçng v√† ph·ªï bi·∫øn, ·ª©ng d·ª•ng r·ªông r√£i. Ai l√†m v·ªÅ computer vision, kh√¥ng s·ªõm th√¨ mu·ªôn c≈©ng s·∫Ω ƒë·ªông ƒë·∫øn n√≥. H·ªá th·ªëng ƒë·ªãnh v·ªã khu√¥n m·∫∑t trong ·∫£nh c·ªßa Facebook, c√°c h·ªá th·ªëng ch·∫•m c√¥ng, gi√°m s√°t nh√¢n vi√™n‚Ä¶ l√† c√°c h·ªá th·ªëng ti√™u bi·ªÉu. Trong b√†i vi·∫øt n√†y, m√¨nh s·∫Ω vi·∫øt v·ªÅ <strong>YOLO</strong> ƒë·ªÉ gi·∫£i quy·∫øt b√†i to√°n Detect.</p>

<div class="imgcap">
    <div>
        <img src="/assets/6-yolo/yolo1.jpg" width="500" />
    </div>
    <div class="thecap">H1: Object detect v·ªõi YOLO </div>
</div>

<p><strong>Required knowledge</strong>: ƒê·ªÉ ƒë·∫£m b·∫£o c√≥ th·ªÉ hi·ªÉu ƒë∆∞·ª£c, b·∫°n c·∫ßn c√≥ ch√∫t ki·∫øn th·ª©c v·ªÅ Deep Learning (neural network, CNN)</p>

<!-- ############ -->
<p><a name="-1"></a></p>

<h2 id="1-t∆∞-t∆∞·ªüng-yolo">1. T∆∞ t∆∞·ªüng YOLO</h2>
<p>Tr∆∞·ªõc ƒë√¢y, b√†i to√°n detect c√≥ v√†i h∆∞·ªõng gi·∫£i quy·∫øt, trong ƒë√≥ ph·ªï bi·∫øn nh·∫•t theo pipe line t·ªëi thi·ªÉu 2 b∆∞·ªõc:</p>

<ul>
  <li>T·ª´ ·∫£nh ƒë·∫ßu v√†o ch·ªçn ra c√°c v√πng ti·ªÅm nƒÉng</li>
  <li>V·ªõi t·ª´ng v√πng ti·∫øn h√†nh classify xem object n·∫±m trong ƒë√≥ kh√¥ng.</li>
</ul>

<p>Tuy nhi√™n d·∫°ng n√†y kh√¥ng ph√π h·ª£p cho real-time. Sau n√†y, YOLO gi·∫£i quy·∫øt kh√° t·ªët v·∫•n ƒë·ªÅ n√†y, l√†m ƒë·ªìng th·ªùi c√°c c√¥ng vi·ªác trong 1 l·∫ßn . V·ªõi ·∫£nh ƒë·∫ßu v√†o, YOLO t√≠nh to√°n v√† tr·∫£ v·ªÅ ƒë·ªìng th·ªùi c√°c th√¥ng tin: <strong>v·ªã tr√≠, k√≠ch c·ª°, lo·∫°i v·∫≠t th·ªÉ</strong>. ƒê√≥ l√† l√≠ do c√°i t√™n YOLO ra ƒë·ªùi: <strong>YOU ONLY LOOK ONE</strong>.</p>

<!-- ############ -->
<p><a name="-2"></a></p>

<h2 id="2-chi-ti·∫øt-thu·∫≠t-to√°n">2. Chi ti·∫øt thu·∫≠t to√°n.</h2>
<div class="imgcap">
    <div>
        <img src="/assets/6-yolo/yolo.gif" width="500" />
    </div>
    <div class="thecap">H1: T·ªïng quan v·ªÅ YOLO </div>
</div>
<hr />

<p>M·∫°ng g·ªìm 2 th√†nh ph·∫ßn ch√≠nh l√† Convolution v√† c√°c Fully-Connected Layer. Ki·∫øn tr√∫c ph·∫ßn Convolution b·∫°n c√≥ th·ªÉ t·ª± code 1 ki·∫øn tr√∫c b·∫•t k√¨ ho·∫∑c transfer learning t·ª´ c√°c pretrain model kh√°c.</p>

<p>·∫¢nh ƒë∆∞·ª£c chia th√†nh c√°c <strong>SxS</strong> ph·∫ßn, th√¥ng th∆∞·ªùng ng∆∞·ªùi ta chia ·∫£nh th√†nh 7x7 , 9x9, 13x13, 19x19 grid. Vi·ªác chia n√†y l√† chia trong <strong>t∆∞·ªüng t∆∞·ª£ng</strong>, kh√¥ng c√≥ b·∫•t k√¨ ph√©p c·∫Øt ·∫£nh n√†o nh∆∞ m·ªôt s·ªë b·∫°n th·∫Øc m·∫Øc. Thay v√†o ƒë√≥, <strong>output</strong> s·∫Ω c√≥ shape l√† \((S, S, n)\), c√≥ nghƒ©a l√† m·ªói v√πng ·∫£nh t∆∞∆°ng ·ª©ng v·ªõi 1 vector ƒë·ªô d√†i n (n = \(5 * B + Class\))</p>

<p>Sau khi ƒëi qua l·ªõp Fully-connected layer, data ƒë∆∞·ª£c <strong>reshape</strong> l·∫°i th√†nh 1 matrix c√≥ shape:</p>

\[(S, S, 5 * B + Class)\]

<p>Trong ƒê√≥:</p>
<ul>
  <li>B l√† Box_number: t·∫°i m·ªói grid, b·∫°n d·ª± ƒëo√°n ra B bounding box.</li>
  <li>V·ªõi m·ªói bounding box, m·∫°ng predict ra 5 con s·ªë bao g·ªìm: x, y, w, h, v√† c (confidence). C l√† x√°c su·∫•t r·∫±ng bounding box ƒë√≥ ch·ª©a object. x,y,w,h n√™n ƒë∆∞·ª£c chu·∫©n h√≥a theo k√≠ch c·ª° c·ªßa grid.</li>
  <li>
    <p>Class: l√† ph√¢n b·ªë x√°c su·∫•t, cho bi·∫øt object ƒë√≥ ƒëang ch·ª©a v·∫≠t th·ªÉ n√†o. VD trong h√¨nh g·ªìm 20 class p1 -&gt; p20</p>
  </li>
  <li>Ta c·∫ßn l√†m quen v·ªõi kh√°i ni·ªám IOU: t·ªâ l·ªá giao nhau gi·ªØa 2 v√πng A, B. ƒê∆∞·ª£c t√≠nh b·∫±ng theo c√¥ng th·ª©c:</li>
</ul>

\[IOU(A, B) = \frac{A \cap B} {A \cup B }\]

<!-- ############ -->
<p><a name="-3"></a></p>

<h2 id="3-yolo-loss-function">3. YOLO Loss function</h2>

<p>Nh∆∞ v·∫≠y b·∫°n ƒë√£ hi·ªÉu ƒëi·ªÉm l√†m n√™n s·ª± kh√°c bi·ªát c·ªßa YOLO ƒë√≥ ch√≠nh l√† ·ªü output c·ªßa n√≥. Output c·ªßa n√≥ ƒë·ªìng th·ªùi c√≥ ƒë·∫ßy ƒë·ªß th√¥ng tin v·ªÅ v·ªã tr√≠, k√≠ch th∆∞·ªõc, x√°c su·∫•t c√≥ objec trong grid, x√°c su·∫•t object ƒë√≥ thu·ªôc class n√†o.</p>

<p>Th·ª© kh√≥ hi·ªÉu v√† kh√≥ code nh·∫•t c·ªßa Yolo n·∫±m ·ªü loss function c·ªßa n√≥. B·ªüi v√¨ output l√† s·ª± k·∫øt h·ª£p nhi·ªÅu lo·∫°i th√¥ng tin kh√°c nhau, n√™n loss c·ªßa n√≥ ph·∫£i ƒë∆∞·ª£c t·∫°o th√†nh 5 loss th√†nh ph·∫ßn. Ch√∫ng ta c·∫ßn hi·ªÉu ƒë∆∞·ª£c loss function.</p>

<div class="imgcap">
    <div>
        <img src="/assets/6-yolo/loss.jpeg" width="800" />
    </div>
    <div class="thecap">H2: Yolo loss function</div>
</div>
<hr />

<p>Loss function c·ªßa YOLO ƒë∆∞·ª£c k·∫øt h·ª£p t·ª´ 5 ph·∫ßn:</p>
<ul>
  <li>Ph·∫ßn 1: Loss v·ªÅ v·ªã tr√≠ to·∫° ƒë·ªô (x,y) t·∫°i nh·ªØng √¥ c√≥ t·ªìn t·∫°i object.</li>
  <li>Ph·∫ßn 2: Loss v·ªÅ k√≠ch th∆∞·ªõc object (w,h) t·∫°i nh·ªØng √¥ c√≥ t·ªìn t·∫°i object.</li>
  <li>Ph·∫ßn 3: Loss v·ªÅ confidence_score t·∫°i nh·ªØng √¥ c√≥ t·ªìn t·∫°i object.</li>
  <li>Ph·∫ßn 4: Loss v·ªÅ confidence_score t·∫°i nh·ªØng √¥ kh√¥ng t·ªìn t·∫°i object.</li>
  <li>Ph·∫ßn 5: Loss x√°c su·∫•t ph√¢n lo·∫°i Class t·∫°i nh·ªØng √¥ c√≥ t·ªìn t·∫°i object.</li>
</ul>

<p><strong>Ch√∫ th√≠ch</strong>:</p>
<ul>
  <li>\(l_{ij}^{obj} = 1\)  n·∫øu box th·ª© j trong √¥ th·ª© i <strong>C√ì</strong> ch·ª©a object, ng∆∞·ª£c l·∫°i = 0</li>
  <li>\(l_{ij}^{noobj} = 1\) n·∫øu box th·ª© j trong √¥ th·ª© i <strong>KH√îNG</strong> ch·ª©a object, ng∆∞·ª£c l·∫°i = 0</li>
  <li>\(l_{i}^{obj}\) = 1  N·∫øu √¥ th·ª© i c√≥ ch∆∞a object.</li>
  <li>\(\lambda_{coord}\) v√† \(\lambda_{noobj}\) l√† tr·ªçng s·ªë cho t·ª´ng Loss th√†nh ph·∫ßn. Trong paper g·ªëc, t√°c gi·∫£ th·ª≠ nghi·ªám nhi·ªÅu l·∫ßn v√† th·∫•y \(\lambda_{coord} = 5\), \(\lambda_{noobj} = 0.5\) cho k·∫øt qu·∫£ t·ªët nh·∫•t.</li>
</ul>

<p>ƒêo·∫°n c√¥ng th·ª©c Loss cho Yolo h∆°i kh√≥ hi·ªÉu, b·∫°n c·∫ßn ƒë·ªçc ƒëi ƒë·ªçc l·∫°i nhi·ªÅu l·∫ßn ƒë·ªÉ hi·ªÉu t∆∞·ªùng t·∫≠n. Nh∆∞ v·∫≠y, trong b√†i n√†y m√¨nh ƒë√£ m√¥ t·∫£ qua v·ªÅ thu·∫≠t to√°n YOLO. Trong b√†i ti·∫øp theo, m√¨nh s·∫Ω n√≥i th√™m v·ªÅ thu·∫≠t to√°n YOLO2 - m·ªôt b·∫£n c·∫£i thi·ªán ƒë√°ng k·ªÉ so v·ªõi YOLO c·∫£ v·ªÅ t·ªëc ƒë·ªô v√† ch·∫•t l∆∞·ª£ng.</p>

<h2 id="link-tham-kh·∫£o">Link tham kh·∫£o:</h2>
<p><a href="https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088">Medium: Realtime Object Detect</a></p>

:ET