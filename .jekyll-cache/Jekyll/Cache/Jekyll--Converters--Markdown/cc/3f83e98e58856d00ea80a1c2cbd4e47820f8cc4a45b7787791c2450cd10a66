I"ç<!-- - [1. Giá»›i thiá»‡u vá» Google Colab](#-google-colab-introduce)
- [2. Tiáº¿n hÃ nh cÃ i Ä‘áº·t](#-setup-colab)
    - [2.1 Táº¡o notebook](#-create-notebook)
    - [2.2 CÃ i Ä‘áº·t mÃ´i trÆ°á»ng vÃ  GPU](#-setup-gpu)
    - [2.3 Káº¿t ná»‘i vá»›i drive](#-connecting-drive)
    - [2.4 Run code](#-test-code) -->

<h2 id="1-giá»›i-thiá»‡u-vá»-google-colab">1. Giá»›i thiá»‡u vá» Google Colab</h2>
<!-- <a name="-google-colab-introduce"></a> -->

<p>NgÃ y nay, Ä‘á»ƒ há»c vÃ  thá»±c hÃ nh vá»›i cÃ¡c model trong deep learning, khÃ´ng cáº§n pháº£i train cÃ¡c model trÃªn mÃ¡y tÃ­nh cÃ¡ nhÃ¢n hay pháº£i sáº¯m nhá»¯ng chiáº¿c GPU Ä‘áº¯t tiá»n, ta hoÃ n toÃ n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c há»‡ thá»‘ng cloud computing nhÆ° cá»§a google, amazon vÃ  1 vÃ i há»‡ thá»‘ng khÃ¡c. HÃ´m nay mÃ¬nh sáº½ hÆ°á»›ng dáº«n train model vá»›i GPU cá»§a google Colab.</p>

<p>NÃ³i qua vá» Google Colab cho nhá»¯ng báº¡n má»›i lÃ m quen, Google Colab cung cáº¥p Colaboratory notebooks - 1 dáº¡ng tÆ°Æ¡ng tá»± nhÆ° jupyter notebook, cho chÃºng ta kháº£ nÄƒng tÃ­nh toÃ¡n máº¡nh tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i Tesla K80 GPU. Khi báº¡n táº¡o 1 notebook, Colab sáº½ táº¡o 1 mÃ¡y áº£o vá»›i Ä‘áº§y Ä‘á»§ nhá»¯ng thá»© cáº§n thiáº¿t nhÆ° thÆ° má»¥c, package, python library cáº§n thiáº¿t. Google Colab há»— trá»£ khÃ¡ toÃ n diá»‡n cÃ¡c thÆ° viá»‡n trong python, phiÃªn báº£n má»›i nháº¥t cá»§a tensoflow, keras, PyTorch, cv2 â€¦ LÆ°u Ã½ lÃ  báº¡n chá»‰ cÃ³ thá»ƒ train tá»‘i Ä‘a 12 tiáº¿ng liÃªn tá»¥c. Váº­y nÃªn khi code nhá»› lÆ°u model trong quÃ¡ trÃ¬nh train trÃ¡nh viá»‡c máº¥t máº¡ng láº¡i pháº£i train láº¡i tá»« Ä‘áº§u.</p>

<div class="imgcap">
<div>
   <img src="/assets/2-colab/tesla-gpu.png" width="500" />
</div>
<div class="thecap">H1: Tesla K80 GPU - GPU báº¡n Ä‘Æ°á»£c sá»­ dá»¥ng Free trÃªn google colab </div>
</div>
<hr />

<p><a name="-setup-colab"> </a></p>

<h2 id="2-tiáº¿n-hÃ nh-cÃ i-Ä‘áº·t">2. Tiáº¿n hÃ nh cÃ i Ä‘áº·t.</h2>
<p><a name="-create-notebook"></a></p>

<h3 id="21-táº¡o-notebook">2.1 Táº¡o notebook</h3>

<ol>
  <li>
    <p>VÃ o Drive cá»§a báº¡n, táº¡o 1 thÆ° má»¥c báº¥t kÃ¬, (VD: AI_COLAB ), nháº£y vÃ o thÆ° má»¥c</p>
  </li>
  <li>
    <p>Chuá»™t pháº£i, chá»n <strong>More</strong>  \(\longrightarrow\) Colaboratory</p>
  </li>
  <li>
    <p>NhÆ° váº­y chÃºng ta Ä‘Ã£ táº¡o ra 1 notebook trÃªn google colab rá»“i</p>
  </li>
</ol>

<div class="imgcap">
<div>
   <img src="/assets/2-colab/colab-create.jpeg" width="400" />
</div>
<div class="thecap">H2: Táº¡o notebook google colab trÃªn drive </div>
</div>
<hr />

<p><a name="-setup-gpu"></a></p>

<h3 id="22-cÃ i-Ä‘áº·t-mÃ´i-trÆ°á»ng-vÃ -gpu">2.2 CÃ i Ä‘áº·t mÃ´i trÆ°á»ng vÃ  GPU</h3>
<p>HÃ£y má»Ÿ notebook vá»«a táº¡o lÃªn, máº·c Ä‘á»‹nh notebook cháº¡y vá»›i CPU. Náº¿u báº¡n muá»‘n Ä‘á»•i sang GPU: Edit \(\longrightarrow\) Notebook Settings \(\longrightarrow\) chá»n python version (máº·c Ä‘á»‹nh python3) vÃ  chá»n Hardware lÃ  GPU \(\longrightarrow\) OK</p>

<hr />

<div class="imgcap">
<div>
   <img src="/assets/2-colab/notebook-setting.png" width="400" />
</div>
<div class="thecap">H3: Setting GPU trÃªn colab notebook </div>
</div>
<hr />

<p><a name="-connecting-drive"></a></p>

<h3 id="23-káº¿t-ná»‘i-colab-vá»›i-drive">2.3 Káº¿t ná»‘i Colab vá»›i drive</h3>

<p>Máº·c Ä‘á»‹nh Colab notebook sáº½ khÃ´ng cÃ³ quyá»n truy cáº­p, Ä‘á»c ghi báº¥t kÃ¬ file nÃ o trÃªn Drive. Tuy nhiÃªn trong thá»±c táº¿, khi train model ta cáº§n 1 nÆ¡i chá»©a dataset dÃ¹ng Ä‘á»ƒ train model. ThÆ°á»ng thÃ¬ ngÆ°á»i ta sáº½ chá»©a dataset táº¡i Drive. Viá»‡c nÃ y khÃ´ng báº¯t buá»™c nhÆ°ng cáº§n thiáº¿t náº¿u báº¡n cÃ³ 1 dataset lá»›n.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="p">.</span><span class="n">mount</span><span class="p">(</span><span class="s">'/content/drive'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Khi run 2 dÃ²ng code nÃ y, trÃªn notebook sáº½ xuáº¥t hiá»‡n 1 Ä‘Æ°á»ng link Ä‘i kÃ¨m vá»›i 1 Ã´ nháº­p input. HÃ£y click vÃ o link, tiáº¿n hÃ nh cáº¥p quyá»n truy cáº­p Drive cho Colab theo hÆ°á»›ng dáº«n. Sau khi tiáº¿n hÃ nh cáº¥p quyá»n xong sáº½ hiá»‡n ra 1 Ä‘oáº¡n token. Copy token Ä‘Ã³ vÃ  Ä‘iá»n vÃ o Ã´ input trÃªn notebook, nháº¥n Enter. NhÆ° váº­y báº¡n Ä‘Ã£ hoÃ n thÃ nh viá»‡c cáº¥p quyá»n cho google colab Ä‘Æ°á»£c phÃ©p truy cáº­p vÃ o drive cá»§a báº¡n (quyá»n Ä‘á»c vÃ  ghi dá»¯ liá»‡u).</p>

<p>Äá»ƒ tháº¥y Ä‘Æ°á»£c nhá»¯ng folder, file Ä‘Ã£ Ä‘Æ°á»£c add tá»« drive vÃ o mÃ´i trÆ°á»ng mÃ¡y áº£o nÃ y, má»Ÿ cá»­a sá»• bÃªn trÃ¡i, click vÃ o Files \(\longrightarrow\) Refresh, báº¡n sáº½ tháº¥y Drive cá»§a báº¡n Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o working directory</p>

<p><a name="-test-code"></a></p>

<h3 id="24-run-code">2.4 Run code</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="p">.</span><span class="n">mount</span><span class="p">(</span><span class="s">'/content/drive'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">from</span> <span class="nn">keras.applications.inception_v3</span> <span class="kn">import</span> <span class="n">InceptionV3</span>

<span class="n">inception</span> <span class="o">=</span> <span class="n">InceptionV3</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="s">"imagenet"</span><span class="p">,</span> <span class="n">include_top</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">inception</span><span class="p">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">get_default_graph</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>NhÆ° váº­y, báº¡n Ä‘Ã£ cÃ³ thá»ƒ run code, train model nhÆ° bÃ¬nh thÆ°á»ng, dá»‹ch vá»¥ nÃ y cá»§a google colab khÃ¡ hay vÃ  tiá»‡n, thÃ­ch há»£p nháº¥t vá»›i Ä‘á»©a nghÃ¨o khÃ´ng cÃ³ tiá»n mua GPU hay thuÃª cloud GPU nhÆ° mÃ¬nh :)) .</p>
:ET